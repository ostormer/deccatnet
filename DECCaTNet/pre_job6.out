========= Beginning preprocessing pipeline for tuh_eeg =========
Loading dataset from /lhome/oskarsto/repos/master-eeg-trans/datasets/TUH/tuh_eeg:
  0%|          | 0/8304 [00:00<?, ?it/s]  1%|          | 84/8304 [00:01<03:11, 43.02it/s]  3%|▎         | 272/8304 [00:02<00:48, 164.16it/s]  6%|▋         | 528/8304 [00:02<00:21, 354.07it/s]  9%|▉         | 784/8304 [00:02<00:12, 584.24it/s] 13%|█▎        | 1040/8304 [00:02<00:09, 764.98it/s] 16%|█▌        | 1296/8304 [00:02<00:07, 890.51it/s] 17%|█▋        | 1380/8304 [00:02<00:08, 811.53it/s] 19%|█▊        | 1552/8304 [00:03<00:07, 853.89it/s] 22%|██▏       | 1808/8304 [00:03<00:06, 1006.29it/s] 25%|██▍       | 2064/8304 [00:03<00:05, 1114.68it/s] 28%|██▊       | 2320/8304 [00:03<00:06, 946.64it/s]  31%|███       | 2576/8304 [00:03<00:05, 1062.96it/s] 34%|███▍      | 2832/8304 [00:04<00:04, 1111.48it/s] 37%|███▋      | 3088/8304 [00:04<00:04, 1121.44it/s] 40%|████      | 3344/8304 [00:04<00:06, 820.20it/s]  43%|████▎     | 3600/8304 [00:05<00:05, 881.67it/s] 46%|████▋     | 3856/8304 [00:05<00:04, 949.77it/s] 50%|████▉     | 4112/8304 [00:05<00:04, 999.62it/s] 53%|█████▎    | 4368/8304 [00:05<00:03, 1021.17it/s] 56%|█████▌    | 4624/8304 [00:06<00:05, 678.59it/s]  59%|█████▉    | 4880/8304 [00:06<00:04, 710.97it/s] 62%|██████▏   | 5136/8304 [00:07<00:03, 809.50it/s] 65%|██████▍   | 5392/8304 [00:07<00:03, 838.98it/s] 68%|██████▊   | 5648/8304 [00:07<00:02, 920.37it/s] 71%|███████   | 5904/8304 [00:08<00:04, 485.66it/s] 74%|███████▍  | 6160/8304 [00:08<00:03, 589.99it/s] 77%|███████▋  | 6416/8304 [00:09<00:02, 684.12it/s] 80%|████████  | 6672/8304 [00:09<00:02, 771.99it/s] 83%|████████▎ | 6928/8304 [00:09<00:01, 816.11it/s] 87%|████████▋ | 7184/8304 [00:09<00:01, 911.48it/s] 90%|████████▉ | 7440/8304 [00:09<00:00, 1006.43it/s] 93%|█████████▎| 7696/8304 [00:10<00:00, 982.50it/s]  96%|█████████▌| 7952/8304 [00:11<00:00, 611.78it/s] 99%|█████████▉| 8208/8304 [00:11<00:00, 719.33it/s]100%|██████████| 8304/8304 [00:11<00:00, 737.51it/s]
Loaded 8304 files.
Start selecting samples with duration over 30 sec
Windowing dataset...
Dropping short recordings and excluded channels:
Kept  7597 recordings
Rescaling to microVolts...
Applying preprocessors to dataset:
  0%|          | 0/7597 [00:00<?, ?it/s]Reading 0 ... 41999  =      0.000 ...   167.996 secs...
Reading 0 ... 197249  =      0.000 ...   788.996 secs...
Reading 0 ... 60999  =      0.000 ...   243.996 secs...
Reading 0 ... 306499  =      0.000 ...  1225.996 secs...
Reading 0 ... 33749  =      0.000 ...   134.996 secs...
Reading 0 ... 356999  =      0.000 ...  1427.996 secs...
Reading 0 ... 235499  =      0.000 ...   941.996 secs...
Reading 0 ... 65249  =      0.000 ...   260.996 secs...
  1%|          | 76/7597 [00:01<02:20, 53.36it/s]  2%|▏         | 152/7597 [00:06<06:08, 20.20it/s]  3%|▎         | 228/7597 [00:11<06:30, 18.87it/s]  4%|▍         | 304/7597 [00:15<06:50, 17.78it/s]  5%|▌         | 380/7597 [00:19<06:37, 18.18it/s]  6%|▌         | 456/7597 [00:24<06:38, 17.93it/s]  7%|▋         | 532/7597 [00:27<06:03, 19.42it/s]  8%|▊         | 608/7597 [00:30<05:47, 20.09it/s]  9%|▉         | 684/7597 [00:36<06:32, 17.60it/s] 10%|█         | 760/7597 [00:40<06:20, 17.96it/s] 11%|█         | 836/7597 [00:43<05:57, 18.93it/s] 12%|█▏        | 912/7597 [00:48<06:11, 17.99it/s] 13%|█▎        | 988/7597 [00:52<05:51, 18.78it/s] 14%|█▍        | 1064/7597 [00:56<05:47, 18.80it/s] 15%|█▌        | 1140/7597 [01:00<05:55, 18.18it/s] 16%|█▌        | 1216/7597 [01:04<05:39, 18.77it/s] 17%|█▋        | 1292/7597 [01:07<05:18, 19.82it/s] 18%|█▊        | 1368/7597 [01:13<05:44, 18.07it/s] 19%|█▉        | 1444/7597 [01:14<04:44, 21.64it/s] 20%|██        | 1520/7597 [01:19<04:58, 20.37it/s] 21%|██        | 1596/7597 [01:23<05:00, 19.94it/s] 22%|██▏       | 1672/7597 [01:27<05:13, 18.92it/s] 23%|██▎       | 1748/7597 [01:31<04:54, 19.84it/s] 24%|██▍       | 1824/7597 [01:34<04:49, 19.97it/s] 25%|██▌       | 1900/7597 [01:38<04:47, 19.83it/s] 26%|██▌       | 1976/7597 [01:43<05:11, 18.06it/s] 27%|██▋       | 2052/7597 [01:48<05:18, 17.42it/s] 28%|██▊       | 2128/7597 [01:53<05:33, 16.38it/s] 29%|██▉       | 2204/7597 [01:59<05:48, 15.49it/s] 30%|███       | 2280/7597 [02:05<06:06, 14.49it/s] 31%|███       | 2356/7597 [02:10<06:04, 14.37it/s] 32%|███▏      | 2432/7597 [02:16<05:59, 14.38it/s] 33%|███▎      | 2508/7597 [02:21<05:49, 14.57it/s] 34%|███▍      | 2584/7597 [02:27<06:03, 13.79it/s] 35%|███▌      | 2660/7597 [02:33<06:07, 13.44it/s] 36%|███▌      | 2736/7597 [02:39<06:08, 13.20it/s] 37%|███▋      | 2812/7597 [02:44<05:59, 13.30it/s] 38%|███▊      | 2888/7597 [02:51<06:06, 12.84it/s] 39%|███▉      | 2964/7597 [02:56<05:50, 13.22it/s] 40%|████      | 3040/7597 [03:03<05:56, 12.77it/s] 41%|████      | 3116/7597 [03:09<05:53, 12.69it/s] 42%|████▏     | 3192/7597 [03:15<05:54, 12.41it/s] 43%|████▎     | 3268/7597 [03:20<05:31, 13.08it/s] 44%|████▍     | 3344/7597 [03:25<05:13, 13.57it/s] 45%|████▌     | 3420/7597 [03:29<04:39, 14.97it/s] 46%|████▌     | 3496/7597 [03:35<04:40, 14.61it/s] 47%|████▋     | 3572/7597 [03:40<04:40, 14.34it/s] 48%|████▊     | 3648/7597 [03:45<04:31, 14.56it/s] 49%|████▉     | 3724/7597 [03:49<04:02, 16.00it/s] 50%|█████     | 3800/7597 [03:55<04:21, 14.51it/s] 51%|█████     | 3876/7597 [04:00<04:12, 14.72it/s] 52%|█████▏    | 3952/7597 [04:05<03:55, 15.45it/s] 53%|█████▎    | 4028/7597 [04:09<03:45, 15.84it/s] 54%|█████▍    | 4104/7597 [04:15<03:53, 14.97it/s] 55%|█████▌    | 4180/7597 [04:19<03:34, 15.94it/s] 56%|█████▌    | 4256/7597 [04:23<03:26, 16.19it/s] 57%|█████▋    | 4332/7597 [04:29<03:28, 15.65it/s] 58%|█████▊    | 4408/7597 [04:34<03:28, 15.28it/s] 59%|█████▉    | 4484/7597 [04:38<03:10, 16.36it/s] 60%|██████    | 4560/7597 [04:43<03:15, 15.55it/s] 61%|██████    | 4636/7597 [04:46<02:48, 17.55it/s] 62%|██████▏   | 4712/7597 [04:50<02:36, 18.46it/s] 63%|██████▎   | 4788/7597 [04:53<02:19, 20.14it/s] 64%|██████▍   | 4864/7597 [04:56<02:06, 21.53it/s] 65%|██████▌   | 4940/7597 [04:59<02:04, 21.37it/s] 66%|██████▌   | 5016/7597 [05:05<02:24, 17.88it/s] 67%|██████▋   | 5092/7597 [05:11<02:32, 16.46it/s] 68%|██████▊   | 5168/7597 [05:16<02:35, 15.61it/s] 69%|██████▉   | 5244/7597 [05:22<02:40, 14.67it/s] 70%|███████   | 5320/7597 [05:28<02:41, 14.12it/s] 71%|███████   | 5396/7597 [05:33<02:34, 14.25it/s] 72%|███████▏  | 5472/7597 [05:40<02:39, 13.36it/s] 73%|███████▎  | 5548/7597 [05:44<02:24, 14.13it/s] 74%|███████▍  | 5624/7597 [05:48<02:10, 15.16it/s] 75%|███████▌  | 5700/7597 [05:53<02:00, 15.71it/s] 76%|███████▌  | 5776/7597 [05:57<01:53, 16.09it/s] 77%|███████▋  | 5852/7597 [06:02<01:46, 16.40it/s] 78%|███████▊  | 5928/7597 [06:07<01:43, 16.05it/s] 79%|███████▉  | 6004/7597 [06:12<01:40, 15.78it/s] 80%|████████  | 6080/7597 [06:16<01:35, 15.95it/s] 81%|████████  | 6156/7597 [06:20<01:21, 17.57it/s] 82%|████████▏ | 6232/7597 [06:24<01:19, 17.18it/s] 83%|████████▎ | 6308/7597 [06:28<01:11, 17.91it/s] 84%|████████▍ | 6384/7597 [06:32<01:05, 18.59it/s] 85%|████████▌ | 6460/7597 [06:37<01:04, 17.65it/s] 86%|████████▌ | 6536/7597 [06:40<00:55, 18.96it/s] 87%|████████▋ | 6612/7597 [06:43<00:48, 20.21it/s] 88%|████████▊ | 6688/7597 [06:49<00:50, 17.96it/s] 89%|████████▉ | 6764/7597 [07:04<01:23,  9.94it/s] 90%|█████████ | 6840/7597 [07:14<01:21,  9.26it/s] 91%|█████████ | 6916/7597 [07:18<01:02, 10.82it/s] 92%|█████████▏| 6992/7597 [07:34<01:18,  7.70it/s] 93%|█████████▎| 7068/7597 [07:40<00:59,  8.83it/s] 94%|█████████▍| 7144/7597 [07:46<00:45,  9.93it/s] 95%|█████████▌| 7220/7597 [07:50<00:32, 11.52it/s] 96%|█████████▌| 7296/7597 [07:54<00:23, 12.61it/s] 97%|█████████▋| 7372/7597 [08:28<00:42,  5.36it/s] 98%|█████████▊| 7448/7597 [08:45<00:29,  5.02it/s] 99%|█████████▉| 7524/7597 [09:03<00:15,  4.70it/s]100%|██████████| 7597/7597 [09:32<00:00, 13.27it/s]
Loading concat dataset from /lhome/oskarsto/repos/master-eeg-trans/datasets/TUH/tuh_eeg_pre/temp, preload=False
  0%|          | 0/7597 [00:00<?, ?it/s]  1%|          | 76/7597 [00:09<15:24,  8.14it/s]  2%|▏         | 152/7597 [00:21<17:51,  6.95it/s]  3%|▎         | 228/7597 [00:32<17:35,  6.98it/s]  4%|▍         | 304/7597 [00:42<17:09,  7.09it/s]  5%|▌         | 380/7597 [00:50<15:11,  7.92it/s]  6%|▌         | 456/7597 [00:57<13:51,  8.59it/s]  7%|▋         | 532/7597 [01:03<11:55,  9.87it/s]  8%|▊         | 608/7597 [01:12<12:28,  9.33it/s]  9%|▉         | 684/7597 [01:24<14:18,  8.05it/s] 10%|█         | 760/7597 [01:30<12:29,  9.12it/s] 11%|█         | 836/7597 [01:37<12:01,  9.37it/s] 12%|█▏        | 912/7597 [01:45<11:53,  9.37it/s] 13%|█▎        | 988/7597 [01:54<11:53,  9.26it/s] 14%|█▍        | 1064/7597 [02:02<11:42,  9.30it/s] 15%|█▌        | 1140/7597 [02:10<11:19,  9.51it/s] 16%|█▌        | 1216/7597 [02:17<11:02,  9.63it/s] 17%|█▋        | 1292/7597 [02:24<10:13, 10.27it/s] 18%|█▊        | 1368/7597 [02:32<10:35,  9.81it/s] 19%|█▉        | 1444/7597 [02:38<09:36, 10.68it/s] 20%|██        | 1520/7597 [02:45<09:28, 10.69it/s] 21%|██        | 1596/7597 [02:53<09:53, 10.11it/s] 22%|██▏       | 1672/7597 [02:56<07:56, 12.42it/s] 23%|██▎       | 1748/7597 [02:58<06:14, 15.62it/s] 24%|██▍       | 1824/7597 [02:59<04:42, 20.47it/s] 25%|██▌       | 1900/7597 [03:00<03:36, 26.27it/s] 26%|██▌       | 1976/7597 [03:01<02:57, 31.62it/s] 27%|██▋       | 2052/7597 [03:03<02:31, 36.53it/s] 28%|██▊       | 2128/7597 [03:04<02:14, 40.51it/s] 29%|██▉       | 2204/7597 [03:06<02:10, 41.43it/s] 30%|███       | 2280/7597 [03:09<02:34, 34.37it/s] 31%|███       | 2356/7597 [03:10<02:14, 39.01it/s] 32%|███▏      | 2432/7597 [03:11<01:58, 43.52it/s] 33%|███▎      | 2508/7597 [03:13<01:46, 47.72it/s] 34%|███▍      | 2584/7597 [03:14<01:39, 50.20it/s] 35%|███▌      | 2660/7597 [03:15<01:33, 52.70it/s] 36%|███▌      | 2736/7597 [03:16<01:25, 56.82it/s] 37%|███▋      | 2812/7597 [03:19<01:46, 44.75it/s] 38%|███▊      | 2888/7597 [03:20<01:36, 48.69it/s] 39%|███▉      | 2964/7597 [03:21<01:29, 52.03it/s] 40%|████      | 3040/7597 [03:23<01:23, 54.26it/s] 41%|████      | 3116/7597 [03:24<01:25, 52.64it/s] 42%|████▏     | 3192/7597 [03:26<01:23, 52.47it/s] 43%|████▎     | 3268/7597 [03:27<01:20, 53.50it/s] 44%|████▍     | 3344/7597 [03:28<01:15, 56.33it/s] 45%|████▌     | 3420/7597 [03:31<01:32, 45.15it/s] 46%|████▌     | 3496/7597 [03:32<01:22, 49.83it/s] 47%|████▋     | 3572/7597 [03:33<01:17, 52.03it/s] 48%|████▊     | 3648/7597 [03:34<01:11, 55.28it/s] 49%|████▉     | 3724/7597 [03:35<01:04, 59.76it/s] 50%|█████     | 3800/7597 [03:37<01:04, 59.08it/s] 51%|█████     | 3876/7597 [03:38<01:02, 59.80it/s] 52%|█████▏    | 3952/7597 [03:39<00:57, 63.26it/s] 53%|█████▎    | 4028/7597 [03:40<00:54, 65.20it/s] 54%|█████▍    | 4104/7597 [03:41<00:53, 64.73it/s] 55%|█████▌    | 4180/7597 [03:42<00:51, 66.48it/s] 56%|█████▌    | 4256/7597 [03:43<00:48, 68.55it/s] 57%|█████▋    | 4332/7597 [03:46<01:09, 46.86it/s] 58%|█████▊    | 4408/7597 [03:47<01:01, 51.53it/s] 59%|█████▉    | 4484/7597 [03:48<00:54, 56.92it/s] 60%|██████    | 4560/7597 [03:49<00:49, 60.95it/s] 61%|██████    | 4636/7597 [03:50<00:43, 68.78it/s] 62%|██████▏   | 4712/7597 [03:51<00:39, 72.36it/s] 63%|██████▎   | 4788/7597 [03:52<00:36, 77.84it/s] 64%|██████▍   | 4864/7597 [03:53<00:33, 81.17it/s] 65%|██████▌   | 4940/7597 [03:54<00:33, 80.47it/s] 66%|██████▌   | 5016/7597 [03:55<00:35, 73.31it/s] 67%|██████▋   | 5092/7597 [03:56<00:36, 69.55it/s] 68%|██████▊   | 5168/7597 [03:57<00:36, 67.03it/s] 69%|██████▉   | 5244/7597 [03:59<00:36, 64.93it/s] 70%|███████   | 5320/7597 [04:00<00:35, 63.98it/s] 71%|███████   | 5396/7597 [04:01<00:37, 59.43it/s] 72%|███████▏  | 5472/7597 [04:03<00:36, 57.86it/s] 73%|███████▎  | 5548/7597 [04:06<00:48, 42.23it/s] 74%|███████▍  | 5624/7597 [04:07<00:40, 49.22it/s] 75%|███████▌  | 5700/7597 [04:08<00:36, 52.58it/s] 76%|███████▌  | 5776/7597 [04:09<00:30, 59.67it/s] 77%|███████▋  | 5852/7597 [04:10<00:27, 62.88it/s] 78%|███████▊  | 5928/7597 [04:11<00:27, 59.81it/s] 79%|███████▉  | 6004/7597 [04:12<00:23, 66.40it/s] 80%|████████  | 6080/7597 [04:13<00:21, 69.47it/s] 81%|████████  | 6156/7597 [04:14<00:19, 74.06it/s] 82%|████████▏ | 6232/7597 [04:15<00:19, 70.85it/s] 83%|████████▎ | 6308/7597 [04:16<00:17, 74.58it/s] 84%|████████▍ | 6384/7597 [04:17<00:15, 75.96it/s] 85%|████████▌ | 6460/7597 [04:18<00:16, 70.74it/s] 86%|████████▌ | 6536/7597 [04:19<00:13, 78.13it/s] 87%|████████▋ | 6612/7597 [04:20<00:11, 83.55it/s] 88%|████████▊ | 6688/7597 [04:22<00:14, 62.29it/s] 89%|████████▉ | 6764/7597 [04:23<00:14, 58.15it/s] 90%|█████████ | 6840/7597 [04:27<00:20, 36.96it/s] 91%|█████████ | 6916/7597 [04:30<00:20, 33.77it/s] 92%|█████████▏| 6992/7597 [04:31<00:15, 39.90it/s] 93%|█████████▎| 7068/7597 [04:32<00:11, 47.74it/s] 94%|█████████▍| 7144/7597 [04:32<00:08, 56.57it/s] 95%|█████████▌| 7220/7597 [04:33<00:05, 65.32it/s] 96%|█████████▌| 7296/7597 [04:34<00:04, 62.81it/s] 97%|█████████▋| 7372/7597 [04:40<00:07, 30.67it/s] 98%|█████████▊| 7448/7597 [04:42<00:04, 31.37it/s] 99%|█████████▉| 7524/7597 [04:51<00:04, 17.90it/s]100%|██████████| 7597/7597 [04:52<00:00, 25.93it/s]
Done rescaling to microVolts
Splitting dataset into windows:
  0%|          | 0/7597 [00:00<?, ?it/s]  1%|          | 76/7597 [00:02<04:13, 29.68it/s]  2%|▏         | 152/7597 [00:04<03:54, 31.81it/s]  3%|▎         | 228/7597 [00:06<03:24, 35.98it/s]  4%|▍         | 304/7597 [00:08<03:20, 36.32it/s]  5%|▌         | 380/7597 [00:10<03:00, 39.90it/s]  6%|▌         | 456/7597 [00:11<02:40, 44.62it/s]  7%|▋         | 532/7597 [00:13<02:31, 46.68it/s]  8%|▊         | 608/7597 [00:14<02:19, 50.17it/s]  9%|▉         | 684/7597 [00:16<02:24, 47.84it/s] 10%|█         | 760/7597 [00:17<02:27, 46.39it/s] 11%|█         | 836/7597 [00:19<02:26, 46.11it/s] 12%|█▏        | 912/7597 [00:21<02:29, 44.68it/s] 13%|█▎        | 988/7597 [00:22<02:21, 46.61it/s] 14%|█▍        | 1064/7597 [00:24<02:24, 45.06it/s] 15%|█▌        | 1140/7597 [00:29<03:54, 27.59it/s] 16%|█▌        | 1216/7597 [00:31<03:14, 32.79it/s] 17%|█▋        | 1292/7597 [00:32<02:44, 38.33it/s] 18%|█▊        | 1368/7597 [00:34<02:41, 38.49it/s] 19%|█▉        | 1444/7597 [00:35<02:19, 44.23it/s] 20%|██        | 1520/7597 [00:37<02:20, 43.35it/s] 21%|██        | 1596/7597 [00:38<02:05, 47.85it/s] 22%|██▏       | 1672/7597 [00:40<02:09, 45.67it/s] 23%|██▎       | 1748/7597 [00:41<01:58, 49.51it/s] 24%|██▍       | 1824/7597 [00:42<01:51, 51.58it/s] 25%|██▌       | 1900/7597 [00:44<01:45, 54.07it/s] 26%|██▌       | 1976/7597 [00:45<01:48, 51.83it/s] 27%|██▋       | 2052/7597 [00:47<01:50, 49.96it/s] 28%|██▊       | 2128/7597 [00:49<01:58, 46.09it/s] 29%|██▉       | 2204/7597 [00:50<01:56, 46.45it/s] 30%|███       | 2280/7597 [00:52<02:01, 43.94it/s] 31%|███       | 2356/7597 [00:55<02:08, 40.81it/s] 32%|███▏      | 2432/7597 [00:57<02:10, 39.45it/s] 33%|███▎      | 2508/7597 [00:58<02:01, 41.81it/s] 34%|███▍      | 2584/7597 [01:00<02:06, 39.58it/s] 35%|███▌      | 2660/7597 [01:02<02:06, 39.15it/s] 36%|███▌      | 2736/7597 [01:04<02:01, 40.16it/s] 37%|███▋      | 2812/7597 [01:06<01:53, 42.33it/s] 38%|███▊      | 2888/7597 [01:08<01:52, 41.84it/s] 39%|███▉      | 2964/7597 [01:09<01:51, 41.43it/s] 40%|████      | 3040/7597 [01:11<01:52, 40.58it/s] 41%|████      | 3116/7597 [01:13<01:44, 42.76it/s] 42%|████▏     | 3192/7597 [01:15<01:47, 41.13it/s] 43%|████▎     | 3268/7597 [01:17<01:45, 40.89it/s] 44%|████▍     | 3344/7597 [01:19<01:43, 41.29it/s] 45%|████▌     | 3420/7597 [01:25<02:49, 24.62it/s] 46%|████▌     | 3496/7597 [01:26<02:21, 29.01it/s] 47%|████▋     | 3572/7597 [01:28<02:03, 32.58it/s] 48%|████▊     | 3648/7597 [01:30<01:59, 33.05it/s] 49%|████▉     | 3724/7597 [01:31<01:39, 38.87it/s] 50%|█████     | 3800/7597 [01:34<01:46, 35.64it/s] 51%|█████     | 3876/7597 [01:35<01:36, 38.61it/s] 52%|█████▏    | 3952/7597 [01:37<01:30, 40.38it/s] 53%|█████▎    | 4028/7597 [01:39<01:25, 41.97it/s] 54%|█████▍    | 4104/7597 [01:41<01:29, 39.08it/s] 55%|█████▌    | 4180/7597 [01:42<01:15, 45.07it/s] 56%|█████▌    | 4256/7597 [01:43<01:11, 46.75it/s] 57%|█████▋    | 4332/7597 [01:45<01:10, 46.12it/s] 58%|█████▊    | 4408/7597 [01:47<01:10, 45.31it/s] 59%|█████▉    | 4484/7597 [01:48<01:03, 49.06it/s] 60%|██████    | 4560/7597 [01:50<01:03, 47.58it/s] 61%|██████    | 4636/7597 [01:51<00:57, 51.54it/s] 62%|██████▏   | 4712/7597 [01:52<00:53, 54.17it/s] 63%|██████▎   | 4788/7597 [01:53<00:45, 61.17it/s] 64%|██████▍   | 4864/7597 [01:54<00:42, 64.04it/s] 65%|██████▌   | 4940/7597 [01:56<00:43, 61.53it/s] 66%|██████▌   | 5016/7597 [01:57<00:46, 55.45it/s] 67%|██████▋   | 5092/7597 [01:59<00:45, 54.64it/s] 68%|██████▊   | 5168/7597 [02:00<00:47, 51.11it/s] 69%|██████▉   | 5244/7597 [02:02<00:51, 46.02it/s] 70%|███████   | 5320/7597 [02:04<00:50, 45.01it/s] 71%|███████   | 5396/7597 [02:06<00:48, 45.39it/s] 72%|███████▏  | 5472/7597 [02:08<00:49, 42.82it/s] 73%|███████▎  | 5548/7597 [02:10<00:49, 41.01it/s] 74%|███████▍  | 5624/7597 [02:11<00:45, 43.56it/s] 75%|███████▌  | 5700/7597 [02:13<00:40, 47.36it/s] 76%|███████▌  | 5776/7597 [02:14<00:37, 48.47it/s] 77%|███████▋  | 5852/7597 [02:15<00:34, 50.80it/s] 78%|███████▊  | 5928/7597 [02:17<00:33, 49.59it/s] 79%|███████▉  | 6004/7597 [02:18<00:31, 50.96it/s] 80%|████████  | 6080/7597 [02:20<00:29, 51.19it/s] 81%|████████  | 6156/7597 [02:21<00:26, 54.52it/s] 82%|████████▏ | 6232/7597 [02:23<00:25, 53.45it/s] 83%|████████▎ | 6308/7597 [02:24<00:22, 58.33it/s] 84%|████████▍ | 6384/7597 [02:31<00:48, 24.80it/s] 85%|████████▌ | 6460/7597 [02:32<00:37, 30.52it/s] 86%|████████▌ | 6536/7597 [02:33<00:30, 35.11it/s] 87%|████████▋ | 6612/7597 [02:34<00:23, 41.18it/s] 88%|████████▊ | 6688/7597 [02:36<00:19, 46.41it/s] 89%|████████▉ | 6764/7597 [02:40<00:26, 31.72it/s] 90%|█████████ | 6840/7597 [02:43<00:25, 29.65it/s] 91%|█████████ | 6916/7597 [02:44<00:18, 36.32it/s] 92%|█████████▏| 6992/7597 [02:47<00:18, 32.27it/s] 93%|█████████▎| 7068/7597 [02:48<00:14, 36.58it/s] 94%|█████████▍| 7144/7597 [02:50<00:11, 39.26it/s] 95%|█████████▌| 7220/7597 [02:51<00:08, 44.67it/s] 96%|█████████▌| 7296/7597 [02:52<00:06, 49.34it/s] 97%|█████████▋| 7372/7597 [02:59<00:09, 23.74it/s] 98%|█████████▊| 7448/7597 [03:01<00:05, 27.33it/s] 99%|█████████▉| 7524/7597 [03:07<00:03, 20.73it/s]100%|██████████| 7597/7597 [03:13<00:00, 39.18it/s]
Dropping all recordings with 0 good windows...
Kept 5982 recordings
Applying preprocessors to dataset:
  0%|          | 0/5982 [00:00<?, ?it/s]  1%|          | 60/5982 [00:03<06:18, 15.64it/s]  2%|▏         | 120/5982 [00:10<09:21, 10.44it/s]  3%|▎         | 180/5982 [00:16<09:30, 10.18it/s]  4%|▍         | 240/5982 [00:24<10:26,  9.17it/s]  5%|▌         | 300/5982 [00:29<09:28,  9.99it/s]  6%|▌         | 360/5982 [00:35<09:07, 10.26it/s]  7%|▋         | 420/5982 [00:41<09:12, 10.06it/s]  8%|▊         | 480/5982 [00:50<10:38,  8.61it/s]  9%|▉         | 540/5982 [00:55<09:51,  9.19it/s] 10%|█         | 600/5982 [01:06<11:24,  7.86it/s] 11%|█         | 660/5982 [01:13<11:19,  7.83it/s] 12%|█▏        | 720/5982 [01:21<11:06,  7.90it/s] 13%|█▎        | 780/5982 [01:28<10:58,  7.90it/s] 14%|█▍        | 840/5982 [01:37<11:14,  7.62it/s] 15%|█▌        | 900/5982 [01:43<10:31,  8.04it/s] 16%|█▌        | 960/5982 [01:48<09:16,  9.03it/s] 17%|█▋        | 1020/5982 [01:58<10:25,  7.94it/s] 18%|█▊        | 1080/5982 [02:01<08:36,  9.49it/s] 19%|█▉        | 1140/5982 [02:10<09:24,  8.58it/s] 20%|██        | 1200/5982 [02:18<09:54,  8.04it/s] 21%|██        | 1260/5982 [02:27<10:18,  7.64it/s] 22%|██▏       | 1320/5982 [02:33<09:32,  8.14it/s] 23%|██▎       | 1380/5982 [02:40<09:03,  8.47it/s] 24%|██▍       | 1440/5982 [02:49<09:44,  7.77it/s] 25%|██▌       | 1500/5982 [02:57<09:46,  7.64it/s] 26%|██▌       | 1560/5982 [03:06<10:01,  7.35it/s] 27%|██▋       | 1620/5982 [03:14<09:49,  7.40it/s] 28%|██▊       | 1680/5982 [03:24<10:10,  7.05it/s] 29%|██▉       | 1740/5982 [03:31<09:46,  7.23it/s] 30%|███       | 1800/5982 [03:42<10:38,  6.55it/s] 31%|███       | 1860/5982 [03:51<10:15,  6.69it/s] 32%|███▏      | 1920/5982 [04:00<10:15,  6.60it/s] 33%|███▎      | 1980/5982 [04:08<09:45,  6.83it/s] 34%|███▍      | 2040/5982 [04:19<10:20,  6.35it/s] 35%|███▌      | 2100/5982 [04:27<09:36,  6.74it/s] 36%|███▌      | 2160/5982 [04:36<09:31,  6.69it/s] 37%|███▋      | 2220/5982 [04:46<09:29,  6.61it/s] 38%|███▊      | 2280/5982 [04:59<10:33,  5.84it/s] 39%|███▉      | 2340/5982 [05:07<09:50,  6.17it/s] 40%|████      | 2400/5982 [05:16<09:30,  6.28it/s] 41%|████      | 2460/5982 [05:26<09:29,  6.19it/s] 42%|████▏     | 2520/5982 [05:39<10:04,  5.73it/s] 43%|████▎     | 2580/5982 [05:48<09:29,  5.98it/s] 44%|████▍     | 2640/5982 [05:57<09:05,  6.13it/s] 45%|████▌     | 2700/5982 [06:06<08:41,  6.29it/s] 46%|████▌     | 2760/5982 [06:13<07:57,  6.75it/s] 47%|████▋     | 2820/5982 [06:22<07:48,  6.75it/s] 48%|████▊     | 2880/5982 [06:34<08:30,  6.08it/s] 49%|████▉     | 2940/5982 [06:42<07:51,  6.45it/s] 50%|█████     | 3000/5982 [06:52<07:44,  6.41it/s] 51%|█████     | 3060/5982 [07:03<08:04,  6.03it/s] 52%|█████▏    | 3120/5982 [07:11<07:31,  6.34it/s] 53%|█████▎    | 3180/5982 [07:19<06:54,  6.76it/s] 54%|█████▍    | 3240/5982 [07:29<07:03,  6.47it/s] 55%|█████▌    | 3300/5982 [07:39<07:03,  6.33it/s] 56%|█████▌    | 3360/5982 [07:46<06:24,  6.82it/s] 57%|█████▋    | 3420/5982 [07:53<05:49,  7.33it/s] 58%|█████▊    | 3480/5982 [08:02<05:57,  7.00it/s] 59%|█████▉    | 3540/5982 [08:09<05:29,  7.42it/s] 60%|██████    | 3600/5982 [08:13<04:31,  8.78it/s] 61%|██████    | 3660/5982 [08:18<03:55,  9.86it/s] 62%|██████▏   | 3720/5982 [08:23<03:38, 10.35it/s] 63%|██████▎   | 3780/5982 [08:26<03:05, 11.88it/s] 64%|██████▍   | 3840/5982 [08:31<03:01, 11.79it/s] 65%|██████▌   | 3900/5982 [08:36<02:53, 12.03it/s] 66%|██████▌   | 3960/5982 [08:42<02:59, 11.26it/s] 67%|██████▋   | 4020/5982 [08:51<03:27,  9.47it/s] 68%|██████▊   | 4080/5982 [09:00<03:44,  8.47it/s] 69%|██████▉   | 4140/5982 [09:10<04:06,  7.48it/s] 70%|███████   | 4200/5982 [09:18<03:59,  7.45it/s] 71%|███████   | 4260/5982 [09:27<04:01,  7.12it/s] 72%|███████▏  | 4320/5982 [09:34<03:40,  7.53it/s] 73%|███████▎  | 4380/5982 [09:41<03:27,  7.72it/s] 74%|███████▍  | 4440/5982 [09:49<03:17,  7.80it/s] 75%|███████▌  | 4500/5982 [09:56<03:03,  8.09it/s] 76%|███████▌  | 4560/5982 [10:03<02:52,  8.25it/s] 77%|███████▋  | 4620/5982 [10:09<02:37,  8.66it/s] 78%|███████▊  | 4680/5982 [10:14<02:22,  9.13it/s] 79%|███████▉  | 4740/5982 [10:23<02:25,  8.54it/s] 80%|████████  | 4800/5982 [10:31<02:29,  7.91it/s] 81%|████████  | 4860/5982 [10:37<02:12,  8.47it/s] 82%|████████▏ | 4920/5982 [10:45<02:08,  8.25it/s] 83%|████████▎ | 4980/5982 [10:52<01:58,  8.44it/s] 84%|████████▍ | 5040/5982 [10:56<01:37,  9.62it/s] 85%|████████▌ | 5100/5982 [11:00<01:20, 10.98it/s] 86%|████████▋ | 5160/5982 [11:06<01:18, 10.41it/s] 87%|████████▋ | 5220/5982 [11:31<02:24,  5.26it/s] 88%|████████▊ | 5280/5982 [11:40<02:06,  5.53it/s] 89%|████████▉ | 5340/5982 [11:49<01:50,  5.83it/s] 90%|█████████ | 5400/5982 [12:00<01:41,  5.74it/s] 91%|█████████▏| 5460/5982 [12:17<01:47,  4.85it/s] 92%|█████████▏| 5520/5982 [12:25<01:24,  5.45it/s] 93%|█████████▎| 5580/5982 [12:32<01:05,  6.11it/s] 94%|█████████▍| 5640/5982 [12:39<00:52,  6.57it/s] 95%|█████████▌| 5700/5982 [12:46<00:39,  7.17it/s] 96%|█████████▋| 5760/5982 [13:10<00:48,  4.62it/s] 97%|█████████▋| 5820/5982 [13:18<00:31,  5.13it/s] 98%|█████████▊| 5880/5982 [13:39<00:24,  4.18it/s] 99%|█████████▉| 5940/5982 [14:17<00:15,  2.79it/s]100%|██████████| 5982/5982 [14:21<00:00,  6.95it/s]
Loading concat dataset from /lhome/oskarsto/repos/master-eeg-trans/datasets/TUH/tuh_eeg_pre/first_preproc, preload=False
  0%|          | 0/5982 [00:00<?, ?it/s]  1%|          | 60/5982 [00:00<01:31, 65.07it/s]  2%|▏         | 120/5982 [00:01<01:22, 71.40it/s]  3%|▎         | 180/5982 [00:02<01:25, 67.63it/s]  4%|▍         | 240/5982 [00:03<01:22, 69.46it/s]  5%|▌         | 300/5982 [00:04<01:21, 69.47it/s]  6%|▌         | 360/5982 [00:05<01:18, 72.01it/s]  7%|▋         | 420/5982 [00:05<01:14, 74.26it/s]  8%|▊         | 480/5982 [00:06<01:13, 75.16it/s]  9%|▉         | 540/5982 [00:07<01:12, 74.79it/s] 10%|█         | 600/5982 [00:08<01:11, 75.63it/s] 11%|█         | 660/5982 [00:09<01:09, 76.28it/s] 12%|█▏        | 720/5982 [00:09<01:09, 75.51it/s] 13%|█▎        | 780/5982 [00:10<01:08, 76.00it/s] 14%|█▍        | 840/5982 [00:11<01:07, 75.80it/s] 15%|█▌        | 900/5982 [00:12<01:06, 76.04it/s] 16%|█▌        | 960/5982 [00:12<01:06, 75.12it/s]Traceback (most recent call last):
  File "main_anakin_pre.py", line 24, in <module>
    run('config_anakin_preprocess')
  File "main_anakin_pre.py", line 16, in run
    pre.run_preprocess(params, global_params)
  File "/lhome/oskarsto/repos/master-eeg-trans/DECCaTNet/preprocessing/preprocess.py", line 648, in run_preprocess
    idx_list = _read_raw(ds_params, global_params)
  File "/lhome/oskarsto/repos/master-eeg-trans/DECCaTNet/preprocessing/preprocess.py", line 458, in _read_raw
    return _preproc_window(ds_params, global_params, dataset=dataset)
  File "/lhome/oskarsto/repos/master-eeg-trans/DECCaTNet/preprocessing/preprocess.py", line 488, in _preproc_window
    return _preproc_first(ds_params, global_params, dataset=windowed_ds)
  File "/lhome/oskarsto/repos/master-eeg-trans/DECCaTNet/preprocessing/preprocess.py", line 523, in _preproc_first
    dataset = preprocess_signals(concat_dataset=dataset, mapping=ch_mapping,
  File "/lhome/oskarsto/repos/master-eeg-trans/DECCaTNet/preprocessing/preprocess.py", line 258, in preprocess_signals
    preprocess(concat_ds=concat_dataset,  # preprocess is in place, doesnt return anything because overwrtie=True
  File "/lhome/oskarsto/repos/master-eeg-trans/.venv/lib/python3.8/site-packages/braindecode/preprocessing/preprocess.py", line 136, in preprocess
    concat_ds_reloaded = load_concat_dataset(
  File "/lhome/oskarsto/repos/master-eeg-trans/.venv/lib/python3.8/site-packages/braindecode/datautil/serialization.py", line 179, in load_concat_dataset
    datasets = Parallel(n_jobs)(
  File "/usr/local/lib/python3.8/dist-packages/joblib/parallel.py", line 1046, in __call__
    while self.dispatch_one_batch(iterator):
  File "/usr/local/lib/python3.8/dist-packages/joblib/parallel.py", line 861, in dispatch_one_batch
    self._dispatch(tasks)
  File "/usr/local/lib/python3.8/dist-packages/joblib/parallel.py", line 779, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File "/usr/local/lib/python3.8/dist-packages/joblib/_parallel_backends.py", line 208, in apply_async
    result = ImmediateResult(func)
  File "/usr/local/lib/python3.8/dist-packages/joblib/_parallel_backends.py", line 572, in __init__
    self.results = batch()
  File "/usr/local/lib/python3.8/dist-packages/joblib/parallel.py", line 262, in __call__
    return [func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/joblib/parallel.py", line 262, in <listcomp>
    return [func(*args, **kwargs)
  File "/lhome/oskarsto/repos/master-eeg-trans/.venv/lib/python3.8/site-packages/braindecode/datautil/serialization.py", line 195, in _load_parallel
    description = pd.read_json(description_file_path, typ='series')
  File "/lhome/oskarsto/repos/master-eeg-trans/.venv/lib/python3.8/site-packages/pandas/util/_decorators.py", line 211, in wrapper
    return func(*args, **kwargs)
  File "/lhome/oskarsto/repos/master-eeg-trans/.venv/lib/python3.8/site-packages/pandas/util/_decorators.py", line 331, in wrapper
    return func(*args, **kwargs)
  File "/lhome/oskarsto/repos/master-eeg-trans/.venv/lib/python3.8/site-packages/pandas/io/json/_json.py", line 733, in read_json
    json_reader = JsonReader(
  File "/lhome/oskarsto/repos/master-eeg-trans/.venv/lib/python3.8/site-packages/pandas/io/json/_json.py", line 818, in __init__
    data = self._get_data_from_filepath(filepath_or_buffer)
  File "/lhome/oskarsto/repos/master-eeg-trans/.venv/lib/python3.8/site-packages/pandas/io/json/_json.py", line 858, in _get_data_from_filepath
    self.handles = get_handle(
  File "/lhome/oskarsto/repos/master-eeg-trans/.venv/lib/python3.8/site-packages/pandas/io/common.py", line 856, in get_handle
    handle = open(
OSError: [Errno 24] Too many open files: '/lhome/oskarsto/repos/master-eeg-trans/datasets/TUH/tuh_eeg_pre/first_preproc/1006/description.json'
 17%|█▋        | 1006/5982 [00:18<01:29, 55.81it/s]
